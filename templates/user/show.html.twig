{% extends 'base.html.twig' %}

{% block title %}User Details{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/show-equipment.css') }}">
    <style>
        /* Add role-specific badge styles */
        .role-badge-admin {
            background-color: #D4EDDA;
            color: #155724;
        }
        .role-badge-staff {
            background-color: #D1ECF1;
            color: #0C5460;
        }
        .role-badge-user {
            background-color: #E2E3E5;
            color: #383D41;
        }
        .status-badge-active {
            background-color: #D4EDDA;
            color: #155724;
        }
        .status-badge-inactive {
            background-color: #F8D7DA;
            color: #721C24;
        }
    </style>
{% endblock %}

{% block body %}
<!-- Modal Overlay -->
<div class="modal-overlay">
  <div class="modal-container">

    <!-- Modal Header -->
    <div class="modal-header">
      <h2 class="modal-title">User Details</h2>
      <button class="modal-close-button" id="close-modal">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">
      
      <!-- User Header Info -->
      <div class="equipment-info-header">
        <h3 class="equipment-name">{{ user.firstName }} {{ user.lastName }}</h3>
        <p class="equipment-id">Username: {{ user.username }}</p>
      </div>

      <!-- User Details -->
      <div class="details-section">
        <dl class="details-grid">
          <div>
            <dt class="detail-term">Email</dt>
            <dd class="detail-description">{{ user.email }}</dd>
          </div>

          <div>
            <dt class="detail-term">First Name</dt>
            <dd class="detail-description">{{ user.firstName }}</dd>
          </div>

          <div>
            <dt class="detail-term">Last Name</dt>
            <dd class="detail-description">{{ user.lastName }}</dd>
          </div>

          <div>
            <dt class="detail-term">Roles</dt>
            <dd>
              {% for role in user.roles %}
                {% if role == 'ROLE_ADMIN' %}
                  <span class="status-badge role-badge-admin">
                    Administrator
                  </span>
                {% elseif role == 'ROLE_STAFF' %}
                  <span class="status-badge role-badge-staff">
                    Staff
                  </span>
                {% elseif role == 'ROLE_USER' %}
                  <span class="status-badge role-badge-user">
                    User
                  </span>
                {% else %}
                  <span class="status-badge">
                    {{ role|replace({'ROLE_': ''}) }}
                  </span>
                {% endif %}
                {% if not loop.last %}<br>{% endif %}
              {% endfor %}
            </dd>
          </div>

          <div>
            <dt class="detail-term">Status</dt>
            <dd>
              {% if user.status == 'active' %}
                <span class="status-badge status-badge-active">
                  Active
                </span>
              {% else %}
                <span class="status-badge status-badge-inactive">
                  Inactive
                </span>
              {% endif %}
            </dd>
          </div>

          <div>
            <dt class="detail-term">Created At</dt>
            <dd class="detail-description">{{ user.createdAt ? user.createdAt|date('Y-m-d H:i:s') : '' }}</dd>
          </div>

          <div>
            <dt class="detail-term">Updated At</dt>
            <dd class="detail-description">{{ user.updatedAt ? user.updatedAt|date('Y-m-d H:i:s') : '' }}</dd>
          </div>
        </dl>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
        <a href="{{ path('user_index') }}" class="modal-action-button">
          Close
        </a>
        <a href="{{ path('user_edit', {'id': user.id}) }}" class="modal-action-button">
          Edit
        </a>
      </div>

    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const modalOverlay = document.querySelector(".modal-overlay");
  const closeButton = document.querySelector(".modal-close-button");

  // ✅ Smoothly fade in modal
  requestAnimationFrame(() => {
    modalOverlay.classList.add("active");
  });

  // ✅ Instantly close when clicking close button
  closeButton.addEventListener("click", (e) => {
    e.preventDefault();
    window.location.href = "{{ path('user_index') }}";
  });
});
</script>
{% endblock %}