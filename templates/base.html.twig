<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}Dashboard{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>âš™</text></svg>">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        
        {% block stylesheets %}
            <link rel="stylesheet" href="{{ asset('styles/dashboard.css') }}?v={{ date().timestamp }}">
        {% endblock %}

        {% block javascripts %}
            {{ encore_entry_script_tags('app') }}
        {% endblock %}
        
        <style>
            /* Top Navigation Bar Styles */
            .top-bar {
                background-color: #2E1F1D;
                color: #D5BDAF;
                padding: 10px 20px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                position: fixed;
                top: 0;
                left: 240px; /* Same as sidebar width */
                right: 0;
                height: 60px;
                z-index: 100;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
            
            .user-info {
                display: flex;
                align-items: center;
                gap: 15px;
            }
            
            .user-avatar {
                width: 35px;
                height: 35px;
                border-radius: 50%;
                background-color: #D5BDAF;
                color: #2E1F1D;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
            }
            
            .profile-link {
                display: flex;
                align-items: center;
                gap: 10px;
                color: #D5BDAF;
                text-decoration: none;
                padding: 5px 10px;
                border-radius: 4px;
                transition: background-color 0.3s;
            }
            
            .profile-link:hover {
                background-color: rgba(213, 189, 175, 0.2);
                color: #D5BDAF;
            }
            
            /* Adjust main content for sidebar and top bar */
            body {
                margin: 0;
                font-family: 'Poppins', sans-serif;
                background-color: #F5F0EB;
                color: #2E1F1D;
            }
            
            .main-content {
                margin-left: 240px;
                padding: 80px 3rem 2rem; /* Adjusted for top bar */
                min-height: 100vh;
            }
        </style>
    </head>
    <body>
        {% if app.user %}
            <!-- Top Navigation Bar -->
            <div class="top-bar">
                <div></div> <!-- Empty div for spacing -->
                <div class="user-info">
                    <a href="{{ path('app_user_profile_index') }}" class="profile-link">
                        <div class="user-avatar">
                            {{ app.user.firstName|first|upper }}{{ app.user.lastName|first|upper }}
                        </div>
                        <span>{{ app.user.firstName }} {{ app.user.lastName }}</span>
                    </a>
                    <span class="badge bg-light text-dark">
                        {% if 'ROLE_ADMIN' in app.user.roles %}
                            Administrator
                        {% else %}
                            Staff
                        {% endif %}
                    </span>
                    <!-- Logout button removed from top bar -->
                </div>
            </div>
        {% endif %}
        
        {% include '_partials/sidebar.html.twig' %}
        
        <div class="main-content">
            <!-- Flash Messages -->
            {% for message in app.flashes('success') %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
            
            {% for message in app.flashes('error') %}
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
            
            {% block body %}{% endblock %}
        </div>
        
        <!-- Bootstrap JS for alerts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            // Auto-dismiss alerts after 5 seconds
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(function() {
                    const alerts = document.querySelectorAll('.alert');
                    alerts.forEach(function(alert) {
                        const bsAlert = new bootstrap.Alert(alert);
                        bsAlert.close();
                    });
                }, 5000);
            });
        </script>
    </body>
</html>